{/* lint disable no-duplicate-headings */}

{/* eslint-disable import/order */}

## Inputs

The following input variables are supported:

### arm\_nodes\_enabled

Description: Whether the database pods can be scheduled on arm64 nodes

Type: `bool`

Default: `true`

### burstable\_nodes\_enabled

Description: Whether the database pods can be scheduled on burstable nodes

Type: `bool`

Default: `true`

### controller\_nodes\_enabled

Description: Whether to allow pods to schedule on EKS Node Group nodes (controller nodes)

Type: `bool`

Default: `false`

### creds\_syncer\_logging\_enabled

Description: Whether to enable logging for the creds-syncer pods

Type: `bool`

Default: `false`

### disabled\_commands

Description: Commands that are disabled in Redis. This can be used to provide global protection against unsafe commands.

Type: `list(string)`

Default:

```json
[
  "FLUSHDB",
  "FLUSHALL"
]
```

### helm\_version

Description: The version of the bitnami/redis helm chart to use

Type: `string`

Default: `"20.5.0"`

### instance\_type\_anti\_affinity\_required

Description: Whether to enable anti-affinity to prevent pods from being scheduled on the same instance type. Defaults to true iff sla\_target == 3.

Type: `bool`

Default: `null`

### lfu\_cache\_enabled

Description: Whether redis will be deployed as an LFU cache

Type: `bool`

Default: `false`

### minimum\_memory\_mb

Description: The minimum memory in Mb to use for the redis nodes

Type: `number`

Default: `25`

### monitoring\_enabled

Description: Whether to allow monitoring CRs to be deployed in the namespace

Type: `bool`

Default: `false`

### namespace

Description: The namespace to deploy to the redis instances into

Type: `string`

Default: n/a

### node\_image\_cached\_enabled

Description: Whether to add the container images to the node image cache for faster startup times

Type: `bool`

Default: `true`

### panfactum\_scheduler\_enabled

Description: Whether to use the Panfactum pod scheduler with enhanced bin-packing

Type: `bool`

Default: `true`

### persistence\_backups\_enabled

Description: Whether to enable backups of the Redis durable storage.

Type: `bool`

Default: `true`

### persistence\_size\_gb

Description: How many GB to initially allocate for persistent storage (will grow automatically as needed). Can not be changed after cluster creation.

Type: `number`

Default: `1`

### persistence\_storage\_increase\_gb

Description: The amount of GB to increase storage by if free space drops below the threshold

Type: `number`

Default: `1`

### persistence\_storage\_increase\_threshold\_percent

Description: Dropping below this percent of free storage will trigger an automatic increase in storage size

Type: `number`

Default: `20`

### persistence\_storage\_limit\_gb

Description: The maximum number of gigabytes of storage to provision for each redis node

Type: `number`

Default: `null`

### pull\_through\_cache\_enabled

Description: Whether to use the ECR pull through cache for the deployed images

Type: `bool`

Default: `true`

### redis\_flags

Description: Extra configuration flags to pass to each redis node

Type: `list(string)`

Default: `[]`

### redis\_save

Description: Sets the save option for periodic snapshotting

Type: `string`

Default: `"300 100"`

### replica\_count

Description: The number of redis replicas to deploy

Type: `number`

Default: `3`

### spot\_nodes\_enabled

Description: Whether the database pods can be scheduled on spot nodes

Type: `bool`

Default: `true`

### vault\_credential\_lifetime\_hours

Description: The lifetime of database credentials generated by Vault

Type: `number`

Default: `16`

### voluntary\_disruption\_window\_cron\_schedule

Description: The times when disruption windows should start

Type: `string`

Default: `"0 4 * * *"`

### voluntary\_disruption\_window\_enabled

Description: Whether to confine voluntary disruptions of pods in this module to specific time windows

Type: `bool`

Default: `false`

### voluntary\_disruption\_window\_seconds

Description: The length of the disruption window in seconds

Type: `number`

Default: `3600`

### voluntary\_disruptions\_enabled

Description: Whether to enable voluntary disruptions of pods in this module.

Type: `bool`

Default: `true`

### vpa\_enabled

Description: Whether the VPA resources should be enabled

Type: `bool`

Default: `true`

### wait

Description: Wait for resources to be in a ready state before proceeding. Disabling this flag will allow upgrades to proceed faster but will disable automatic rollbacks. As a result, manual intervention may be required for deployment failures.

Type: `bool`

Default: `true`

## Outputs

The following outputs are exported:

### admin\_creds\_secret

Description: The name of the Kubernetes Secret holding credentials for the admin role in the Redis database

### admin\_role

Description: The Vault role used to get admin credentials for the created Redis cluster

### master\_set

Description: The value for the master set to use when configuring Sentinel-aware Redis clients

### match\_labels

Description: A label selector that matches all Redis pods in the cluster

### match\_labels\_master

Description: A label selector that matches only the Redis master pod in the cluster

### namespace

Description: Kubernetes namespace where module resources are created

### reader\_creds\_secret

Description: The name of the Kubernetes Secret holding credentials for the reader role in the Redis database

### reader\_role

Description: The Vault role used to get read-only credentials for the created Redis cluster

### redis\_host

Description: A service address that points to all Redis nodes

### redis\_host\_list

Description: A list of domain names for every Redis pod in the cluster

### redis\_master\_host

Description: A service address that points to only the writable redis master

### redis\_port

Description: The port that the Redis servers listen on

### redis\_sentinel\_host

Description: A service address that points to the Redis Sentinels

### redis\_sentinel\_port

Description: The port that the Sentinel servers listen on

### root\_name

Description: The name of the root user of the database

### root\_password

Description: The password for root user of the database

### superuser\_creds\_secret

Description: The name of the Kubernetes Secret holding credentials for the superuser role in the Redis database

### superuser\_role

Description: The Vault role used to get superuser credentials for the created Redis cluster

## Providers

The following providers are needed by this module:

- [helm](https://registry.terraform.io/providers/hashicorp/helm/2.12.1/docs) (2.12.1)

- [kubectl](https://registry.terraform.io/providers/alekc/kubectl/2.1.3/docs) (2.1.3)

- [kubernetes](https://registry.terraform.io/providers/hashicorp/kubernetes/2.34.0/docs) (2.34.0)

- [pf](https://registry.terraform.io/providers/panfactum/pf/0.0.7/docs) (0.0.7)

- [random](https://registry.terraform.io/providers/hashicorp/random/3.6.3/docs) (3.6.3)

- [vault](https://registry.terraform.io/providers/hashicorp/vault/4.5.0/docs) (4.5.0)

{/* eslint-enable import/order */}

{/* lint enable no-duplicate-headings */}
